<?xml version="1.0"?>
<launch>
    <arg name="camera" default="ds435i"/>
    
    <!-- DS435i Camera -->
    <include file="$(find campusrover_sensors)/launch/sensors/realsense_camera.launch.xml">
        <arg name="camera" value="$(arg camera)"/>
    </include>

    <!-- Apriltag Detactor -->
    <include file="$(find apriltag_ros)/launch/detector.launch">
        <arg name="camera" value="$(arg camera)"/>
        <arg name="image" default="/ds435i/color/image_raw"/>
        <arg name="border_size" value="0"/>
    </include>

    <!-- Apriltag pose estimator -->
    <node pkg="apriltag_ros" name="apriltag_pose_estimator"
        type="apriltag_pose_estimator" output="screen" ns="$(arg camera)">
        <remap from="~apriltags" to="/ds435i/tags"/>
        <remap from="~camera_info" to="/ds435i/color/camera_info"/>
        <remap from="~transform" to="transform_cam_apriltag"/>
        <param name="broadcast_tf" type="bool" value="true"/>
        <param name="auto_disconnect" type="bool" value="true"/>
        <rosparam param="tag_descriptions">
        [{id: 0, size: 0.085},
         {id: 1, size: 0.03}]
        </rosparam>
    </node>

    <!-- test_apriltag_yz_table_pbvs -->
    <node pkg="visual_servoing3" name="test_yz_table_pbvs" type="test_yz_table_pbvs" output="screen">
        <param name="button_detection_distance" value="0.5" />
    </node>

</launch>
